// For format details, see https://aka.ms/devcontainer.json. For config options, see the
// README at: https://github.com/devcontainers/templates/tree/main/src/javascript-node
{
  "name": "Kenober site agence (Astro, Tailwindcss, TinaCMS Node.js)",
  // Or use a Dockerfile or Docker Compose file. More info: https://containers.dev/guide/dockerfile
  "image": "mcr.microsoft.com/devcontainers/javascript-node:1-20-bullseye",
  "workspaceMount": "source=${localWorkspaceFolder},target=/2024-astro-kenober,type=bind,consistency=cached",
  "workspaceFolder": "/2024-astro-kenober",
  "mounts": [
    {
      "source": "2024-astro-kenober_node_modules",
      "target": "${containerWorkspaceFolder}/node_modules",
      "type": "volume",
    },
  ],

  // Features to add to the dev container. More info: https://containers.dev/features.
  "features": {
    "ghcr.io/rio/features/chezmoi:1": {},
  },

  // Use 'forwardPorts' to make a list of ports inside the container available locally.
  "forwardPorts": [4321, 4001],

  // Use 'postCreateCommand' to run commands after the container is created.
  "postCreateCommand": {
    ".nvmrc": "echo $(node --version) > .nvmrc",
    "git config --global core.autocrlf true": "git config --global core.autocrlf true",
    "chown node_modules": "sudo chown -R node:node node_modules",
    "prettier": "npm i -g prettier",
  },

  // Configure tool-specific properties.
  "customizations": {
    "vscode": {
      "extensions": [
        "bradlc.vscode-tailwindcss",
        "unifiedjs.vscode-mdx",
        "esbenp.prettier-vscode",
        "vscode-icons-team.vscode-icons",
        "astro-build.astro-vscode",
        "kamikillerto.vscode-colorize",
      ],
      "settings": {
        "tailwindCSS.rootFontSize": 16,
        "tailwindCSS.classAttributes": [
          "class",
          "className",
          "classes",
          ".*Classes.*",
        ],
        "tailwindCSS.experimental.classRegex": [
          ["Classes \\=([^;]*);", "'([^']*)'"],
          ["Classes \\=([^;]*);", "\"([^\"]*)\""],
          ["Classes \\=([^;]*);", "\\`([^\\`]*)\\`"],
          "[a-zA-Z]+Class\\s?[=:]\\s?[\"']([^\"^']+)",
          "[a-zA-Z]+ClassName=\"([^\"]*)\"",
          "[a-zA-Z]+Class=\"([^\"]*)\"",
        ],
        "prettier.prettierPath": "/usr/local/share/npm-global/lib/node_modules/prettier/index.cjs",
        "prettier.documentSelectors": ["**/*.astro"],
        "[astro]": {
          "editor.defaultFormatter": "esbenp.prettier-vscode",
        },
        "colorize.include": [
          "**/*.js",
          "**/*.jsx",
          "**/*.ts",
          "**/*.tsx",
          "**/*.mjs",
          "**/*.css",
          "**/*.astro",
        ],
        // Kenoker ID Project :
        // https://track.toggl.com/7917687/projects/198311101/dashboard
        "toggl.defaultProjectId": 198311101,
      },
    },
  },
  "portsAttributes": {
    "4001": {
      "label": "Tina API",
    },
    "4321": {
      "label": "Astro",
    },
  },

  // Uncomment to connect as root instead. More info: https://aka.ms/dev-containers-non-root.
  // "remoteUser": "root"
}
